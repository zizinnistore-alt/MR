<!-- views/student-info.ejs -->
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชูุฑูุฑ ุฃุฏุงุก ุงูุทุงูุจ: <%= student.student_name %></title>

    <!-- PWA Manifest & Theme Color -->
    <link rel="manifest" href="/manifest.json?unique_code=<%= student.unique_code %>">
    <meta name="theme-color" content="#4f46e5"> <!-- Indigo-600 color -->

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Framer Motion for Animations -->
    <script src="https://cdn.jsdelivr.net/npm/framer-motion@10/dist/framer-motion.umd.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- html5-qrcode library -->
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>

    <style>
        body { font-family: 'Cairo', sans-serif; }
        .chart-container { position: relative; height: 40vh; width: 100%; }
        :root { direction: rtl; }
        
        /* Styles for QR Scanner */
        #qr-reader {
            width: 100%;
            max-width: 500px;
            margin: 1rem auto;
            border: 2px solid #ccc;
            border-radius: 8px;
        }
        #qr-reader-results {
            margin-top: 1rem;
            font-weight: bold;
            text-align: center;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">
    <% if (data && data.personal_message) { %>
        <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 m-4 rounded-md shadow-lg" role="alert">
            <div class="flex">
                <div class="py-1"><svg class="fill-current h-6 w-6 text-yellow-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zM9 11v4h2v-4H9zm0-4h2v2H9V7z"/></svg></div>
                <div>
                    <p class="font-bold">ุฑุณุงูู ูููู ูู ุงููุณุชุฑ</p>
                    <p class="text-sm"><%= data.personal_message %></p>
                </div>
            </div>
        </div>
    <% } %>
<div class="container mx-auto p-4 md:p-8">
    <!-- Animated Help Button and Modal -->
<div id="help-button-container" class="fixed bottom-6 left-6 z-50">
    <!-- 1. ุฃุถููุง id="help-btn" ููุฒุฑ -->
    <button id="help-btn" class="bg-indigo-600 text-white rounded-full w-16 h-16 flex items-center justify-center shadow-lg transform transition-transform hover:scale-110 animate-pulse">
        <i class="fas fa-question text-2xl"></i>
    </button>
</div>

<!-- 2. ุฃุถููุง ุงููุงูุฐุฉ ุงูููุจุซูุฉ (Modal) ุจุงููุงูู. ุณุชููู ูุฎููุฉ ุจุดูู ุงูุชุฑุงุถู -->
<div id="help-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 hidden">
    <div class="bg-white rounded-lg shadow-xl p-6 md:p-8 w-full max-w-2xl mx-auto" dir="rtl">
        <!-- ุฑุฃุณ ุงููุงูุฐุฉ -->
        <div class="flex justify-between items-center border-b pb-3 mb-4">
            <h3 class="text-2xl font-bold text-indigo-700">ุฏููู ุงููุณุงุนุฏุฉ</h3>
            <button id="close-modal-btn" class="text-gray-500 hover:text-gray-800 text-2xl">ร</button>
        </div>
        
        <!-- ูุญุชูู ุงููุณุงุนุฏุฉ -->
        <div class="space-y-4 text-gray-700">
            <div>
                <h4 class="font-bold text-lg"><i class="fas fa-chart-line text-indigo-500 mr-2"></i> ููู ุงูุฅุญุตุงุฆูุงุช</h4>
                <p>ุชูุธูุฑ ุงูุจุทุงูุงุช ุงูุนูููุฉ ููุฎุตุงู ูุฃุฏุงุฆู ููุงุฑูุฉ ุจุจุงูู ุงูุทูุงุจ ูู ููุณ ุงููุฌููุนุฉ. <strong class="text-indigo-600">ุชุฑุชูุจู ูู ุงูุญุตุต</strong> ููุถุญ ูููุนู ุจูุงุกู ุนูู ูุชูุณุท ุฏุฑุฌุงุชู.</p>
            </div>
            <div>
                <h4 class="font-bold text-lg"><i class="fas fa-qrcode text-teal-500 mr-2"></i> ุชุณุฌูู ุงูุญุถูุฑ</h4>
                <p>ุงุถุบุท ุนูู ุฒุฑ <strong class="text-teal-600">ุชุณุฌูู ุงูุญุถูุฑ ุจุงูู QR</strong> ููุฌู ูุงููุฑุง ูุงุชูู ูุญู ุงูููุฏ ุงูุฐู ูุนุฑุถู ุงููุณุงุนุฏ ูุชุณุฌูู ุญุถูุฑู ูู ุงูุญุตุฉ ุงูุญุงููุฉ.</p>
            </div>
            <div>
                <h4 class="font-bold text-lg"><i class="fas fa-star text-yellow-500 mr-2"></i> ุงูุฏุฑุฌุงุช ูุงูุฃููุงู</h4>
                <ul class="list-disc list-inside mt-2 space-y-1">
                    <li>ุงูุฏุฑุฌุงุช ุจุงูููู <strong class="text-green-600">ุงูุฃุฎุถุฑ</strong> ุชุนูู ุฃู ุฃุฏุงุกู ุฃุนูู ูู ูุชูุณุท ุงูุตู.</li>
                    <li>ุงูุฏุฑุฌุงุช ุจุงูููู <strong class="text-red-600">ุงูุฃุญูุฑ</strong> ุชุนูู ุฃู ุฃุฏุงุกู ุฃูู ูู ูุชูุณุท ุงูุตู.</li>
                </ul>
            </div>
            <div>
                <h4 class="font-bold text-lg"><i class="fas fa-mobile-alt text-purple-500 mr-2"></i> ุชุซุจูุช ุงูุชุทุจูู</h4>
                <p>ูููุตูู ุงูุณุฑูุน ูุตูุญุชูุ ููููู ุชุซุจูุชูุง ูุชุทุจูู ุนูู ูุงุชูู. <strong class="text-indigo-600">ูู ุงูููุชุฑุถ ุฃู ุชุธูุฑ ูู ูุงูุฐุฉ ุงูุชุซุจูุช ุงูุขู.</strong> ุฅุฐุง ูู ุชุธูุฑุ ููุฏ ูุนูู ูุฐุง ุฃู ุงูุชุทุจูู ูุซุจุช ุจุงููุนู ุฃู ุฃู ูุชุตูุญู ูุง ูุฏุนู ูุฐู ุงูููุฒุฉ.</p>
            </div>
        </div>
    </div>
</div>
        
    <!-- Student Header -->
    <div id="student-header" class="text-center mb-8 p-6 bg-white rounded-xl shadow-md">
        <h1 class="text-3xl md:text-4xl font-extrabold text-indigo-700">ูุฑุญุจุงูุ <%= student.student_name %></h1>
        <p class="text-gray-500 mt-2">ูุฐุง ูู ุชูุฑูุฑ ุฃุฏุงุฆู ุงูุฏุฑุงุณู ุงูููุตู</p>
    </div>

    <!-- QR Code Scanner Section -->
    <div id="qr-section" class="my-8 text-center">
        <button id="start-scan-btn" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform hover:scale-105">
            <i class="fas fa-qrcode mr-2"></i> ุชุณุฌูู ุงูุญุถูุฑ ุจุงูู QR
        </button>
        <div id="qr-reader" style="display: none;"></div>
        <div id="qr-reader-results"></div>
    </div>

    <!-- Motivational Message -->
    <% 
        let message = '';
        let messageClass = '';
        if (stats.session.rankPercentage <= 10) {
            message = `ููุชุงุฒ! ุฃูุช ูู ุฃูุถู 10% ูู ุงูุทูุงุจ ูู ูุชูุณุท ุงูุญุตุต. ุงุณุชูุฑ ูู ูุฐุง ุงูุฃุฏุงุก ุงูุฑุงุฆุน! ๐`;
            messageClass = 'bg-green-100 border-green-500 text-green-800';
        } else if (stats.session.rankPercentage >= 80) {
            message = `ุชุญุชุงุฌ ุฅูู ุจุฐู ุงููุฒูุฏ ูู ุงูุฌูุฏ ูู ุงูุญุตุต ุงููุงุฏูุฉ. ูุญู ูุซู ุจูุฏุฑุงุชู ููููููุง ูุณุงุนุฏุชู! ๐ช`;
            messageClass = 'bg-yellow-100 border-yellow-500 text-yellow-800';
        }
    %>
    <% if (message) { %>
        <div id="motivational-message" class="p-4 mb-8 border-r-4 rounded-lg shadow-sm <%= messageClass %>">
            <p class="font-bold"><%= message %></p>
        </div>
    <% } %>

    <!-- Stats Cards -->
    <div id="stats-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="bg-white p-6 rounded-xl shadow-md text-center">
            <h3 class="text-lg font-bold text-gray-500">ูุชูุณุท ุฏุฑุฌุงุช ุงูุญุตุต</h3>
            <p class="text-4xl font-extrabold text-indigo-600 mt-2"><%= stats.session.average.toFixed(1) %></p>
            <p class="text-sm text-gray-400 mt-1">ูุชูุณุท ุงูุตู: <%= stats.session.classAverage.toFixed(1) %></p>
        </div>
        <div class="bg-white p-6 rounded-xl shadow-md text-center">
            <h3 class="text-lg font-bold text-gray-500">ุชุฑุชูุจู ูู ุงูุญุตุต</h3>
            <p class="text-4xl font-extrabold text-indigo-600 mt-2"><%= stats.session.rank %></p>
             <p class="text-sm text-gray-400 mt-1">
                ุถูู ุฃูุถู <%= stats.session.rankPercentage.toFixed(0) %>%
            </p>
        </div>
        <div class="bg-white p-6 rounded-xl shadow-md text-center">
            <h3 class="text-lg font-bold text-gray-500">ูุณุจุฉ ุงูุญุถูุฑ</h3>
            <% 
                const sessionsForAttendance = (data && data.sessions) ? data.sessions : [];
                const totalSessions = sessionsForAttendance.length;
                const attendedSessions = sessionsForAttendance.filter(s => s && s.attendance === 'ุญุงุถุฑ').length;
                const attendancePercentage = totalSessions > 0 ? (attendedSessions / totalSessions) * 100 : 0;
            %>
            <p class="text-4xl font-extrabold text-indigo-600 mt-2"><%= attendancePercentage.toFixed(0) %>%</p>
            <p class="text-sm text-gray-400 mt-1"><%= attendedSessions %> ูู <%= totalSessions %> ุญุตุต</p>
        </div>
    </div>

    <!-- Detailed Grades Tables -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Major Exams -->
        <div class="bg-white p-6 rounded-xl shadow-md">
            <h2 class="text-2xl font-bold mb-4">ุงูุงูุชุญุงูุงุช ุงููุจุฑู</h2>
            <div class="space-y-4">
            <% Object.keys(stats.exams).forEach(examName => { %>
                <div class="border border-gray-200 p-4 rounded-lg">
                    <h4 class="font-bold text-lg text-indigo-700"><%= examName %></h4>
                    <div class="flex justify-between items-center mt-2 text-sm">
                        <span class="font-semibold">ุฏุฑุฌุชู: <span class="text-xl font-extrabold <%= stats.exams[examName].grade > (stats.exams[examName].classAverage) ? 'text-green-500' : 'text-red-500' %>"><%= stats.exams[examName].grade %></span></span>
                        <span>ูุชูุณุท ุงูุตู: <%= stats.exams[examName].classAverage %></span>
                        <span>ุชุฑุชูุจู: <%= stats.exams[examName].rank %> / <%= stats.exams[examName].totalStudents %></span>
                    </div>
                </div>
            <% }); %>
            </div>
        </div>

        <!-- Session Grades -->
        <div class="bg-white p-6 rounded-xl shadow-md">
            <h2 class="text-2xl font-bold mb-4">ุฏุฑุฌุงุช ุงูุญุตุต</h2>
            <div class="max-h-96 overflow-y-auto">
                <table class="w-full text-center">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="p-3 font-bold">ุงูุญุตุฉ</th>
                            <th class="p-3 font-bold">ุงูุฏุฑุฌุฉ</th>
                            <th class="p-3 font-bold">ุงูุญุถูุฑ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (data && data.sessions && data.sessions.length > 0) { %>
                            <% data.sessions.forEach((session, index) => { %>
                                <% if (session) { %>
                                    <tr class="border-b">
                                        <td class="p-3">ุญุตุฉ <%= index + 1 %></td>
                                        <td class="p-3 font-bold <%= session.grade > 5 ? 'text-green-600' : 'text-red-600' %>"><%= session.grade ?? '-' %></td>
                                        <td class="p-3">
                                            <span class="px-2 py-1 text-xs rounded-full <%= session.attendance === 'ุญุงุถุฑ' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800' %>">
                                                <%= session.attendance ?? 'ูู ูุณุฌู' %>
                                            </span>
                                        </td>
                                    </tr>
                                <% } %>
                            <% }); %>
                        <% } else { %>
                            <tr>
                                <td colspan="3" class="p-4 text-center text-gray-500">ูุง ุชูุฌุฏ ุจูุงูุงุช ุญุตุต ูุนุฑุถูุง.</td>
                            </tr>
                        <% } %>
                        </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- QR Scanner Script -->
<script>
    const startScanBtn = document.getElementById('start-scan-btn');
    const qrReaderDiv = document.getElementById('qr-reader');
    const resultsDiv = document.getElementById('qr-reader-results');
    const studentUniqueCode = "<%= student.unique_code %>";

    if (typeof Html5Qrcode !== 'undefined') {
        const html5QrCode = new Html5Qrcode("qr-reader");

        const qrCodeSuccessCallback = (decodedText, decodedResult) => {
            html5QrCode.stop().catch(err => console.error("Failed to stop camera:", err));
            resultsDiv.innerHTML = `<span class="text-blue-600 font-bold">ุชู ุงููุณุญ! ุฌุงุฑู ุงูุชุญูู...</span>`;
            
            fetch('/scan/verify', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ token: decodedText, unique_code: studentUniqueCode })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    resultsDiv.innerHTML = `<span class="text-green-600 font-bold">${data.message}</span>`;
                    setTimeout(() => window.location.reload(), 2000); // Reload to show updated attendance
                } else {
                    resultsDiv.innerHTML = `<span class="text-red-600 font-bold">${data.message}</span>`;
                }
            })
            .catch(error => {
                console.error('Error during fetch:', error);
                resultsDiv.innerHTML = `<span class="text-red-600 font-bold">ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุฎุงุฏู.</span>`;
            });
        };

        const config = { fps: 10, qrbox: { width: 250, height: 250 } };

        startScanBtn.addEventListener('click', () => {
            qrReaderDiv.style.display = 'block';
            startScanBtn.style.display = 'none';
            resultsDiv.innerHTML = '';
            
            html5QrCode.start({ facingMode: "environment" }, config, qrCodeSuccessCallback)
            .catch(err => {
                resultsDiv.innerHTML = `<span class="text-red-600 font-bold">ูุง ูููู ุชุดุบูู ุงููุงููุฑุง. ูุฑุฌู ุงูุณูุงุญ ุจุงููุตูู ุฅูููุง.</span>`;
            });
        });
    }
</script>

<!-- PWA Service Worker Registration Script -->
<script>
    // ุงูุชุฃูุฏ ูู ุฃู ุงููุชุตูุญ ูุฏุนู Service Workers
    if ('serviceWorker' in navigator) {
        // ุงุณุชุฎุฏุงู window.onload ูุถูู ุฃู ุชุณุฌูู ุงูู Service Worker ูุง ูุคุฎุฑ ุชุญููู ุงูุตูุญุฉ
        window.addEventListener('load', () => {
            // ุชุณุฌูู ููู ุงูู Service Worker
            navigator.serviceWorker.register('/sw.js?unique_code=<%= student.unique_code %>')
                .then(registration => {
                    console.log('Service Worker ุชู ุชุณุฌููู ุจูุฌุงุญ:', registration);
                })
                .catch(error => {
                    console.log('ูุดู ุชุณุฌูู Service Worker:', error);
                });
        });
    }
</script>
<script>
    // ุงูุชุธุฑ ุชุญููู ุงูุตูุญุฉ ุจุงููุงูู
    window.addEventListener('load', () => {
        // ุชุญุฏูุฏ ุงูุนูุงุตุฑ ูู ุงูู DOM
        const helpBtn = document.getElementById('help-btn');
        const helpModal = document.getElementById('help-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');

        // ุงูุชุญูู ูู ูุฌูุฏ ุงูุนูุงุตุฑ ูุชุฌูุจ ุงูุฃุฎุทุงุก
        if (helpBtn && helpModal && closeModalBtn) {
            
            // ูุธููุฉ ููุชุญ ุงููุงูุฐุฉ
            const openModal = () => {
                helpModal.classList.remove('hidden'); // ุฅุฒุงูุฉ ูุฆุฉ hidden ูุฅุธูุงุฑ ุงููุงูุฐุฉ
            };

            // ูุธููุฉ ูุฅุบูุงู ุงููุงูุฐุฉ
            const closeModal = () => {
                helpModal.classList.add('hidden'); // ุฅุถุงูุฉ ูุฆุฉ hidden ูุฅุฎูุงุก ุงููุงูุฐุฉ
            };

            // ุฑุจุท ุงูุฃุญุฏุงุซ ุจุงูุฃุฒุฑุงุฑ
            helpBtn.addEventListener('click', openModal); // ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงููุณุงุนุฏุฉุ ุงูุชุญ ุงููุงูุฐุฉ
            closeModalBtn.addEventListener('click', closeModal); // ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ ุงูุฅุบูุงูุ ุฃุบูู ุงููุงูุฐุฉ

            // ุฅุบูุงู ุงููุงูุฐุฉ ุนูุฏ ุงูุถุบุท ุนูู ุงูุฎูููุฉ ุงูุณูุฏุงุก
            helpModal.addEventListener('click', (event) => {
                // ุฅุฐุง ูุงู ุงูุนูุตุฑ ุงูุฐู ุชู ุงูุถุบุท ุนููู ูู ุงูุฎูููุฉ ููุณูุง (ูููุณ ุงููุญุชูู ุงูุฏุงุฎูู)
                if (event.target === helpModal) {
                    closeModal();
                }
            });
        }
    });
</script>
<!-- Help Modal and PWA Install Script -->
<script>
    // ุงูุชุธุฑ ุชุญููู ุงูุตูุญุฉ ุจุงููุงูู
    window.addEventListener('load', () => {
        // --- START PWA Install Logic ---

        let deferredPrompt; // ุณูุชู ุงุณุชุฎุฏุงู ูุฐุง ุงููุชุบูุฑ ูุชุฎุฒูู ุญุฏุซ ุงูุชุซุจูุช

        // 1. ุงุณุชูุน ููุญุฏุซ ุงูุฐู ูุฑุณูู ุงููุชุตูุญ ุนูุฏูุง ูููู ุงูุชุทุจูู ูุงุจูุงู ููุชุซุจูุช
        window.addEventListener('beforeinstallprompt', (e) => {
            // ููุน ุธููุฑ ูุงูุฐุฉ ุงูุชุซุจูุช ุงููุตุบุฑุฉ ุงูุงูุชุฑุงุถูุฉ ูู ุจุนุถ ุงููุชุตูุญุงุช
            e.preventDefault();
            // ุงุญูุธ ุงูุญุฏุซ ุญุชู ูุชููู ูู ุชุดุบููู ูุงุญููุง
            deferredPrompt = e;
            console.log('PWA: ุชุทุจูู ุฌุงูุฒ ููุชุซุจูุช.');
            
            // ููููู ููุง ุฅุธูุงุฑ ุฒุฑ ุงูุชุซุจูุช ุงูุฎุงุต ุจู ุฅุฐุง ุฃุฑุฏุช
            // ุนูู ุณุจูู ุงููุซุงูุ ูููููุง ุฅุธูุงุฑ ุฒุฑ ุฎุงุต ุฏุงุฎู ูุงูุฐุฉ ุงููุณุงุนุฏุฉ
            const installButtonInModal = document.getElementById('pwa-install-btn');
            if(installButtonInModal) {
                installButtonInModal.style.display = 'inline-flex'; // ุฅุธูุงุฑ ุงูุฒุฑ
            }
        });

        // --- END PWA Install Logic ---


        // --- START Help Modal Logic ---
        const helpBtn = document.getElementById('help-btn');
        const helpModal = document.getElementById('help-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');

        if (helpBtn && helpModal && closeModalBtn) {
            
            const openModal = () => {
                helpModal.classList.remove('hidden');
            };

            const closeModal = () => {
                helpModal.classList.add('hidden');
            };

            // 2. ุชุนุฏูู ูุธููุฉ ุงูููุฑ ุนูู ุฒุฑ ุงููุณุงุนุฏุฉ ุงูุฑุฆูุณู
            helpBtn.addEventListener('click', () => {
                // ุฃููุงูุ ุงูุชุญ ูุงูุฐุฉ ุงููุณุงุนุฏุฉ ูุงููุนุชุงุฏ
                openModal();

                // ุซุงููุงูุ ุชุญูู ููุง ุฅุฐุง ูุงู ูุฏููุง ุญุฏุซ ุชุซุจูุช ูุญููุธ
                if (deferredPrompt) {
                    console.log('PWA: ุนุฑุถ ูุงูุฐุฉ ุงูุชุซุจูุช.');
                    // ุงุนุฑุถ ูุงูุฐุฉ ุงูุชุซุจูุช ุงูุฎุงุตุฉ ุจุงููุชุตูุญ
                    deferredPrompt.prompt();
                    
                    // ุงูุชุธุฑ ูุชุฑู ูุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุฏ ูุจู ุงูุชุซุจูุช ุฃู ูุง
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('PWA: ุงููุณุชุฎุฏู ูุจู ุงูุชุซุจูุช.');
                        } else {
                            console.log('PWA: ุงููุณุชุฎุฏู ุฑูุถ ุงูุชุซุจูุช.');
                        }
                        // ุงูุณุญ ุงูุญุฏุซ ุงููุญููุธุ ุญูุซ ูุง ูููู ุงุณุชุฎุฏุงูู ุฅูุง ูุฑุฉ ูุงุญุฏุฉ
                        deferredPrompt = null;
                    });
                } else {
                    console.log('PWA: ุงูุชุทุจูู ุบูุฑ ูุงุจู ููุชุซุจูุช ุงูุขู ุฃู ุชู ุชุซุจูุชู ุจุงููุนู.');
                }
            });

            closeModalBtn.addEventListener('click', closeModal);

            helpModal.addEventListener('click', (event) => {
                if (event.target === helpModal) {
                    closeModal();
                }
            });
        }
        // --- END Help Modal Logic ---
    });
</script>
</body>
</html>